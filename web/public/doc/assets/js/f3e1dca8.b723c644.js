"use strict";(self.webpackChunkbluearc_tiger_docs=self.webpackChunkbluearc_tiger_docs||[]).push([[223],{689(e,n,l){l.r(n),l.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"legacy/relayer-hosting-scaling-fees","title":"BlueARC Relayer Hosting, Scaling, and Host Fees","description":"Goals","source":"@site/docs/legacy/10-relayer-hosting-scaling-fees.md","sourceDirName":"legacy","slug":"/legacy/relayer-hosting-scaling-fees","permalink":"/doc/docs/legacy/relayer-hosting-scaling-fees","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"9. Branding","permalink":"/doc/docs/legacy/branding"},"next":{"title":"Real Proof Generation Plan (BlueARC)","permalink":"/doc/docs/legacy/real-proof-generation-plan"}}');var r=l(4848),i=l(8453);const d={},c="BlueARC Relayer Hosting, Scaling, and Host Fees",o={},a=[{value:"Goals",id:"goals",level:2},{value:"A) Railway Deployment (managed)",id:"a-railway-deployment-managed",level:2},{value:"B) Raspberry Pi Deployment (self-hosted)",id:"b-raspberry-pi-deployment-self-hosted",level:2},{value:"C) Relay Mesh Scaling Pattern",id:"c-relay-mesh-scaling-pattern",level:2},{value:"D) Relay Host Fee Collection",id:"d-relay-host-fee-collection",level:2},{value:"E) Production Guidance",id:"e-production-guidance",level:2}];function t(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"bluearc-relayer-hosting-scaling-and-host-fees",children:"BlueARC Relayer Hosting, Scaling, and Host Fees"})}),"\n",(0,r.jsx)(n.h2,{id:"goals",children:"Goals"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Make relayer hosting straightforward for third-party operators."}),"\n",(0,r.jsx)(n.li,{children:"Support managed hosting (Railway) and edge/self-hosting (Raspberry Pi)."}),"\n",(0,r.jsx)(n.li,{children:"Standardize fee collection for relay operators."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"a-railway-deployment-managed",children:"A) Railway Deployment (managed)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Create a new service from the ",(0,r.jsx)(n.code,{children:"relayer/"})," directory."]}),"\n",(0,r.jsx)(n.li,{children:"Add managed Postgres + Redis in Railway."}),"\n",(0,r.jsxs)(n.li,{children:["Copy ",(0,r.jsx)(n.code,{children:"<repo-root>/relayer/.env.railway.example"})," values into Railway variables."]}),"\n",(0,r.jsxs)(n.li,{children:["Set required secrets:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"RELAYER_PRIVATE_KEY"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"RPC_URL"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"POSTGRES_URL"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"REDIS_URL"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"POOL_ALLOWLIST"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Keep healthcheck on ",(0,r.jsx)(n.code,{children:"GET /health"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Point UI relayer mesh at the Railway URL."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Note: ",(0,r.jsx)(n.code,{children:"relayer/railway.json"})," is included for Dockerfile-based Railway deploy."]}),"\n",(0,r.jsx)(n.h2,{id:"b-raspberry-pi-deployment-self-hosted",children:"B) Raspberry Pi Deployment (self-hosted)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Use 64-bit Raspberry Pi OS and Docker."}),"\n",(0,r.jsxs)(n.li,{children:["In ",(0,r.jsx)(n.code,{children:"<repo-root>/relayer"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"cp .env.host.example .env.host"})}),"\n",(0,r.jsxs)(n.li,{children:["set ",(0,r.jsx)(n.code,{children:"RELAYER_PRIVATE_KEY"}),", ",(0,r.jsx)(n.code,{children:"RPC_URL"}),", and ",(0,r.jsx)(n.code,{children:"POOL_ALLOWLIST"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Start stack:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"docker compose -f docker-compose.host.yml up -d --build"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Confirm:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"curl http://127.0.0.1:8080/health"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Alternative bare-metal env file is provided at:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"<repo-root>/relayer/.env.rpi.example"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"c-relay-mesh-scaling-pattern",children:"C) Relay Mesh Scaling Pattern"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Run multiple independent relayers (different hosts/regions/keys)."}),"\n",(0,r.jsxs)(n.li,{children:["Each relayer uses its own:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"signer key"}),"\n",(0,r.jsx)(n.li,{children:"Postgres + Redis"}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"POOL_ALLOWLIST"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Frontend already supports mesh health/failover routing."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Recommended controls per host:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RATE_LIMIT_*"})," tuned to capacity"]}),"\n",(0,r.jsxs)(n.li,{children:["abuse thresholds (",(0,r.jsx)(n.code,{children:"ABUSE_*"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["metrics scrape via ",(0,r.jsx)(n.code,{children:"/metrics"})]}),"\n",(0,r.jsxs)(n.li,{children:["alerting webhook via ",(0,r.jsx)(n.code,{children:"ALERT_WEBHOOK_URL"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"d-relay-host-fee-collection",children:"D) Relay Host Fee Collection"}),"\n",(0,r.jsx)(n.p,{children:"Relayer fee is paid on successful withdraw to the relayer signer address."}),"\n",(0,r.jsx)(n.p,{children:"Use the sweep script to move earned ETH to host treasury:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Script: ",(0,r.jsx)(n.code,{children:"<repo-root>/relayer/scripts/sweep-fees.js"})]}),"\n",(0,r.jsxs)(n.li,{children:["Command:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"npm run sweep:fees"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Required env:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"RELAYER_PAYOUT_ADDRESS"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"RELAYER_PRIVATE_KEY"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"RPC_URL"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Safety env:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RELAYER_SWEEP_DRY_RUN=true"})," (test first)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RELAYER_SWEEP_RESERVE_WEI"})," (keep gas buffer)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RELAYER_MIN_SWEEP_WEI"})," (skip tiny transfers)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"e-production-guidance",children:"E) Production Guidance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use distinct keys per relay host."}),"\n",(0,r.jsxs)(n.li,{children:["Use remote signer mode (",(0,r.jsx)(n.code,{children:"SIGNER_MODE=remote"}),") for KMS/HSM in production."]}),"\n",(0,r.jsxs)(n.li,{children:["Restrict pools with ",(0,r.jsx)(n.code,{children:"POOL_ALLOWLIST"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Set strict CORS and run behind TLS."}),"\n",(0,r.jsx)(n.li,{children:"Keep relayer process non-custodial: no user note storage."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},8453(e,n,l){l.d(n,{R:()=>d,x:()=>c});var s=l(6540);const r={},i=s.createContext(r);function d(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);